<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="theme-color" content="#0d4a0d">
    <title>Poker - Chip Simulator</title>
    <link rel="stylesheet" href="style.css">
    <link rel="manifest" href="manifest.json">
</head>
<body>
    <div class="container">
        <!-- Poker Header -->
        <div class="header">
            <a href="index.html" class="home-btn" title="Home">ğŸ </a>
            <button class="sound-btn" onclick="toggleSound()" title="Toggle Sound">ğŸ”Š</button>
            <button class="fullscreen-btn" onclick="toggleFullscreen()" title="Toggle Fullscreen">â›¶</button>
            <h1>POKER</h1>
        </div>
        
        <!-- Poker Game -->
        <div id="pokerContent"></div>
    </div>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-database-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    <script src="firebase-config.js"></script>
    <script src="cloud-storage.js"></script>
    
    <!-- Sound System -->
    <script>
        let soundEnabled = localStorage.getItem('soundEnabled') !== 'false';
        let audioContext = null;
        
        function toggleSound() {
            soundEnabled = !soundEnabled;
            localStorage.setItem('soundEnabled', soundEnabled);
            document.querySelectorAll('.sound-btn').forEach(btn => {
                btn.textContent = soundEnabled ? 'ğŸ”Š' : 'ğŸ”‡';
                btn.classList.toggle('muted', !soundEnabled);
            });
        }
        
        function initAudio() {
            if (!audioContext) {
                audioContext = new (window.AudioContext || window.webkitAudioContext)();
            }
            return audioContext;
        }
        
        function playSound(type) {
            if (!soundEnabled) return;
            try {
                const ctx = initAudio();
                if (ctx.state === 'suspended') ctx.resume();
                
                switch(type) {
                    case 'push': // Chip/bet sound
                        playChipSound(ctx);
                        break;
                    case 'win':
                        playWinSound(ctx);
                        break;
                    case 'lose':
                        playLoseSound(ctx);
                        break;
                }
            } catch (e) {
                console.log('Audio error:', e);
            }
        }
        
        function playChipSound(ctx) {
            for (let i = 0; i < 3; i++) {
                setTimeout(() => {
                    const osc = ctx.createOscillator();
                    const gain = ctx.createGain();
                    osc.connect(gain);
                    gain.connect(ctx.destination);
                    osc.frequency.setValueAtTime(800 + Math.random() * 400, ctx.currentTime);
                    osc.type = 'square';
                    gain.gain.setValueAtTime(0.08, ctx.currentTime);
                    gain.gain.exponentialRampToValueAtTime(0.01, ctx.currentTime + 0.05);
                    osc.start(ctx.currentTime);
                    osc.stop(ctx.currentTime + 0.05);
                }, i * 30);
            }
        }
        
        function playWinSound(ctx) {
            const notes = [523.25, 659.25, 783.99];
            notes.forEach((freq, i) => {
                setTimeout(() => {
                    const osc = ctx.createOscillator();
                    const gain = ctx.createGain();
                    osc.connect(gain);
                    gain.connect(ctx.destination);
                    osc.frequency.setValueAtTime(freq, ctx.currentTime);
                    osc.type = 'triangle';
                    gain.gain.setValueAtTime(0.12, ctx.currentTime);
                    gain.gain.exponentialRampToValueAtTime(0.01, ctx.currentTime + 0.2);
                    osc.start(ctx.currentTime);
                    osc.stop(ctx.currentTime + 0.2);
                }, i * 100);
            });
        }
        
        function playLoseSound(ctx) {
            const osc = ctx.createOscillator();
            const gain = ctx.createGain();
            osc.connect(gain);
            gain.connect(ctx.destination);
            osc.frequency.setValueAtTime(200, ctx.currentTime);
            osc.frequency.exponentialRampToValueAtTime(100, ctx.currentTime + 0.3);
            osc.type = 'sawtooth';
            gain.gain.setValueAtTime(0.1, ctx.currentTime);
            gain.gain.exponentialRampToValueAtTime(0.01, ctx.currentTime + 0.3);
            osc.start(ctx.currentTime);
            osc.stop(ctx.currentTime + 0.3);
        }
        
        function toggleFullscreen() {
            if (!document.fullscreenElement) {
                document.documentElement.requestFullscreen?.();
            } else {
                document.exitFullscreen?.();
            }
        }
        
        // Update sound button on load
        document.addEventListener('DOMContentLoaded', () => {
            document.querySelectorAll('.sound-btn').forEach(btn => {
                btn.textContent = soundEnabled ? 'ğŸ”Š' : 'ğŸ”‡';
                btn.classList.toggle('muted', !soundEnabled);
            });
        });
    </script>
    
    <script src="poker.js"></script>
</body>
</html>
